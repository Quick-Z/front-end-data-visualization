import{q as t,s as e,B as a,k as i,C as s,b as n,o as r}from"./vendor.c4f0aeec.js";import{C as o,g as l,c as h,b as _,d as m,S as L,a as d,L as p,V as f}from"./Vector.e623616e.js";import{T as c}from"./TileImage.6d4ae649.js";import{bI as u,r as b,bJ as g,Z as x,f as v,bK as y,bL as S,bc as P,b9 as w,bM as M,i as j,q as T,bN as E,I as X,a3 as F,A as C,bn as B,s as G,G as Y,ad as k,R as O,ah as R,O as I,ap as N,M as W,V as z}from"./ol.c16104b5.js";import{T as A}from"./Text.c9cf381f.js";import{B as U}from"./BingMaps.addd526c.js";function V(t,e,a){for(var i,s,n,r,o,l,h=[],_=t(0),m=t(1),L=e(_),d=e(m),p=[m,_],f=[d,L],c=[1,0],u={},b=1e5;--b>0&&c.length>0;)n=c.pop(),_=p.pop(),L=f.pop(),(l=n.toString())in u||(h.push(L[0],L[1]),u[l]=!0),r=c.pop(),m=p.pop(),d=f.pop(),s=e(i=t(o=(n+r)/2)),g(s[0],s[1],L[0],L[1],d[0],d[1])<a?(h.push(d[0],d[1]),u[l=r.toString()]=!0):(c.push(r,o,o,n),f.push(d,s,s,L),p.push(m,i,i,_));return h}var q,D=(q=function(t,e){return(q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function a(){this.constructor=t}q(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),K=new h({color:"rgba(0,0,0,0.2)"}),J=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],Z=function(t){function e(e){var a=this,i=e||{},s=v({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},i);return delete s.maxLines,delete s.strokeStyle,delete s.targetSize,delete s.showLabels,delete s.lonLabelFormatter,delete s.latLabelFormatter,delete s.lonLabelPosition,delete s.latLabelPosition,delete s.lonLabelStyle,delete s.latLabelStyle,delete s.intervals,(a=t.call(this,s)||this).projection_=null,a.maxLat_=1/0,a.maxLon_=1/0,a.minLat_=-1/0,a.minLon_=-1/0,a.maxX_=1/0,a.maxY_=1/0,a.minX_=-1/0,a.minY_=-1/0,a.targetSize_=void 0!==i.targetSize?i.targetSize:100,a.maxLines_=void 0!==i.maxLines?i.maxLines:100,a.meridians_=[],a.parallels_=[],a.strokeStyle_=void 0!==i.strokeStyle?i.strokeStyle:K,a.fromLonLatTransform_=void 0,a.toLonLatTransform_=void 0,a.projectionCenterLonLat_=null,a.bottomLeft_=null,a.bottomRight_=null,a.topLeft_=null,a.topRight_=null,a.meridiansLabels_=null,a.parallelsLabels_=null,i.showLabels&&(a.lonLabelFormatter_=null==i.lonLabelFormatter?y.bind(a,"EW"):i.lonLabelFormatter,a.latLabelFormatter_=null==i.latLabelFormatter?y.bind(a,"NS"):i.latLabelFormatter,a.lonLabelPosition_=null==i.lonLabelPosition?0:i.lonLabelPosition,a.latLabelPosition_=null==i.latLabelPosition?1:i.latLabelPosition,a.lonLabelStyleBase_=new _({text:void 0!==i.lonLabelStyle?i.lonLabelStyle.clone():new A({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new m({color:"rgba(0,0,0,1)"}),stroke:new h({color:"rgba(255,255,255,1)",width:3})})}),a.lonLabelStyle_=function(t){var e=t.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(e),this.lonLabelStyleBase_}.bind(a),a.latLabelStyleBase_=new _({text:void 0!==i.latLabelStyle?i.latLabelStyle.clone():new A({font:"12px Calibri,sans-serif",textAlign:"right",fill:new m({color:"rgba(0,0,0,1)"}),stroke:new h({color:"rgba(255,255,255,1)",width:3})})}),a.latLabelStyle_=function(t){var e=t.get("graticule_label");return this.latLabelStyleBase_.getText().setText(e),this.latLabelStyleBase_}.bind(a),a.meridiansLabels_=[],a.parallelsLabels_=[],a.addEventListener(S.POSTRENDER,a.drawLabels_.bind(a))),a.intervals_=void 0!==i.intervals?i.intervals:J,a.setSource(new L({loader:a.loaderFunction.bind(a),strategy:a.strategyFunction.bind(a),features:new P,overlaps:!1,useSpatialIndex:!1,wrapX:i.wrapX})),a.featurePool_=[],a.lineStyle_=new _({stroke:a.strokeStyle_}),a.loadedExtent_=null,a.renderedExtent_=null,a.setRenderOrder(null),a}return D(e,t),e.prototype.strategyFunction=function(t,e){var a=t.slice();return this.projection_&&this.getSource().getWrapX()&&w(a,this.projection_),this.loadedExtent_&&(M(this.loadedExtent_,a,e)?a=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[a]},e.prototype.loaderFunction=function(t,e,a){this.loadedExtent_=t;var i=this.getSource(),s=this.getExtent()||[-1/0,-1/0,1/0,1/0],n=j(s,t);if(!(this.renderedExtent_&&T(this.renderedExtent_,n)||(this.renderedExtent_=n,E(n)))){var r=X(n),o=e*e/4;(!this.projection_||!F(this.projection_,a))&&this.updateProjectionInfo_(a),this.createGraticule_(n,r,e,o);var l,h=this.meridians_.length+this.parallels_.length;for(this.meridiansLabels_&&(h+=this.meridians_.length),this.parallelsLabels_&&(h+=this.parallels_.length);h>this.featurePool_.length;)l=new d,this.featurePool_.push(l);var _=i.getFeaturesCollection();_.clear();var m,L,p=0;for(m=0,L=this.meridians_.length;m<L;++m)(l=this.featurePool_[p++]).setGeometry(this.meridians_[m]),l.setStyle(this.lineStyle_),_.push(l);for(m=0,L=this.parallels_.length;m<L;++m)(l=this.featurePool_[p++]).setGeometry(this.parallels_[m]),l.setStyle(this.lineStyle_),_.push(l)}},e.prototype.addMeridian_=function(t,e,a,i,s,n){var r=this.getMeridian_(t,e,a,i,n);if(C(r.getExtent(),s)){if(this.meridiansLabels_){var o=this.lonLabelFormatter_(t);n in this.meridiansLabels_?this.meridiansLabels_[n].text=o:this.meridiansLabels_[n]={geom:new B([]),text:o}}this.meridians_[n++]=r}return n},e.prototype.addParallel_=function(t,e,a,i,s,n){var r=this.getParallel_(t,e,a,i,n);if(C(r.getExtent(),s)){if(this.parallelsLabels_){var o=this.latLabelFormatter_(t);n in this.parallelsLabels_?this.parallelsLabels_[n].text=o:this.parallelsLabels_[n]={geom:new B([]),text:o}}this.parallels_[n++]=r}return n},e.prototype.drawLabels_=function(t){var e=t.frameState.viewState.rotation,a=t.frameState.extent,i=X(a),s=a;if(e){var n=G(a),r=Y(a),h=Math.abs(Math.cos(e)),_=Math.abs(Math.sin(e)),m=(_*r-h*n)/(_*_-h*h),L=(_*n-h*r)/(_*_-h*h);s=[i[0]-m/2,i[1]-L/2,i[0]+m/2,i[1]+L/2]}var d=0,p=0,f=this.latLabelPosition_<.5,c=this.projection_.getExtent(),b=G(c);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!k(c,a)&&(d=Math.floor((a[0]-c[0])/b),p=Math.ceil((a[2]-c[2])/b),f=f!==Math.abs(e)>Math.PI/2);for(var g=function(t){var e=t.inversePixelTransform[0],a=t.frameState,i=u(t.inversePixelTransform.slice(),a.coordinateToPixelTransform),s=l(a.viewState.resolution,e);return new o(t.context,e,a.extent,i,a.viewState.rotation,s,void 0)}(t),x=d;x<=p;++x){var v=this.meridians_.length+this.parallels_.length,y=void 0,S=void 0,P=void 0,w=void 0;if(this.meridiansLabels_)for(S=0,P=this.meridiansLabels_.length;S<P;++S){var M=this.meridians_[S];if(e||0!==x)(j=M.clone()).translate(x*b,0),j.rotate(-e,i),(w=this.getMeridianPoint_(j,s,S)).rotate(e,i);else w=this.getMeridianPoint_(M,a,S);(y=this.featurePool_[v++]).setGeometry(w),y.set("graticule_label",this.meridiansLabels_[S].text),g.drawFeature(y,this.lonLabelStyle_(y))}if(this.parallelsLabels_&&(x===d&&f||x===p&&!f))for(S=0,P=this.parallels_.length;S<P;++S){var j;M=this.parallels_[S];if(e||0!==x)(j=M.clone()).translate(x*b,0),j.rotate(-e,i),(w=this.getParallelPoint_(j,s,S)).rotate(e,i);else w=this.getParallelPoint_(M,a,S);(y=this.featurePool_[v++]).setGeometry(w),y.set("graticule_label",this.parallelsLabels_[S].text),g.drawFeature(y,this.latLabelStyle_(y))}}},e.prototype.createGraticule_=function(t,e,a,i){var s=this.getInterval_(a);if(-1==s)return this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var n=!1,r=this.projection_.getExtent(),o=G(r);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!k(r,t)&&(G(t)>=o?(t[0]=r[0],t[2]=r[2]):n=!0);var l=[O(e[0],this.minX_,this.maxX_),O(e[1],this.minY_,this.maxY_)],h=this.toLonLatTransform_(l);isNaN(h[1])&&(h[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);var _,m,L,d,p=O(h[0],this.minLon_,this.maxLon_),f=O(h[1],this.minLat_,this.maxLat_),c=this.maxLines_,u=t;n||(u=[O(t[0],this.minX_,this.maxX_),O(t[1],this.minY_,this.maxY_),O(t[2],this.minX_,this.maxX_),O(t[3],this.minY_,this.maxY_)]);var b=R(u,this.toLonLatTransform_,void 0,8),g=b[3],x=b[2],v=b[1],y=b[0];if(n||(I(u,this.bottomLeft_)&&(y=this.minLon_,v=this.minLat_),I(u,this.bottomRight_)&&(x=this.maxLon_,v=this.minLat_),I(u,this.topLeft_)&&(y=this.minLon_,g=this.maxLat_),I(u,this.topRight_)&&(x=this.maxLon_,g=this.maxLat_),g=O(g,f,this.maxLat_),x=O(x,p,this.maxLon_),v=O(v,this.minLat_,f),y=O(y,this.minLon_,p)),p=Math.floor(p/s)*s,d=O(p,this.minLon_,this.maxLon_),m=this.addMeridian_(d,v,g,i,t,0),_=0,n)for(;(d-=s)>=y&&_++<c;)m=this.addMeridian_(d,v,g,i,t,m);else for(;d!=this.minLon_&&_++<c;)d=Math.max(d-s,this.minLon_),m=this.addMeridian_(d,v,g,i,t,m);if(d=O(p,this.minLon_,this.maxLon_),_=0,n)for(;(d+=s)<=x&&_++<c;)m=this.addMeridian_(d,v,g,i,t,m);else for(;d!=this.maxLon_&&_++<c;)d=Math.min(d+s,this.maxLon_),m=this.addMeridian_(d,v,g,i,t,m);for(this.meridians_.length=m,this.meridiansLabels_&&(this.meridiansLabels_.length=m),f=Math.floor(f/s)*s,L=O(f,this.minLat_,this.maxLat_),m=this.addParallel_(L,y,x,i,t,0),_=0;L!=this.minLat_&&_++<c;)L=Math.max(L-s,this.minLat_),m=this.addParallel_(L,y,x,i,t,m);for(L=O(f,this.minLat_,this.maxLat_),_=0;L!=this.maxLat_&&_++<c;)L=Math.min(L+s,this.maxLat_),m=this.addParallel_(L,y,x,i,t,m);this.parallels_.length=m,this.parallelsLabels_&&(this.parallelsLabels_.length=m)},e.prototype.getInterval_=function(t){for(var e=this.projectionCenterLonLat_[0],a=this.projectionCenterLonLat_[1],i=-1,s=Math.pow(this.targetSize_*t,2),n=[],r=[],o=0,l=this.intervals_.length;o<l;++o){var h=O(this.intervals_[o]/2,0,90),_=O(a,-90+h,90-h);if(n[0]=e-h,n[1]=_-h,r[0]=e+h,r[1]=_+h,this.fromLonLatTransform_(n,n),this.fromLonLatTransform_(r,r),Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)<=s)break;i=this.intervals_[o]}return i},e.prototype.getMeridian_=function(t,e,a,i,s){var n=function(t,e,a,i,s){var n=x("EPSG:4326");return V((function(i){return[t,e+(a-e)*i]}),b(n,i),s)}(t,e,a,this.projection_,i),r=this.meridians_[s];return r?(r.setFlatCoordinates(N.XY,n),r.changed()):(r=new p(n,N.XY),this.meridians_[s]=r),r},e.prototype.getMeridianPoint_=function(t,e,a){var i=t.getFlatCoordinates(),s=1,n=i.length-1;i[s]>i[n]&&(s=n,n=1);var r=Math.max(e[1],i[s]),o=Math.min(e[3],i[n]),l=O(e[1]+Math.abs(e[1]-e[3])*this.lonLabelPosition_,r,o),h=[i[s-1]+(i[n-1]-i[s-1])*(l-i[s])/(i[n]-i[s]),l],_=this.meridiansLabels_[a].geom;return _.setCoordinates(h),_},e.prototype.getMeridians=function(){return this.meridians_},e.prototype.getParallel_=function(t,e,a,i,s){var n=function(t,e,a,i,s){var n=x("EPSG:4326");return V((function(i){return[e+(a-e)*i,t]}),b(n,i),s)}(t,e,a,this.projection_,i),r=this.parallels_[s];return r?(r.setFlatCoordinates(N.XY,n),r.changed()):r=new p(n,N.XY),r},e.prototype.getParallelPoint_=function(t,e,a){var i=t.getFlatCoordinates(),s=0,n=i.length-2;i[s]>i[n]&&(s=n,n=0);var r=Math.max(e[0],i[s]),o=Math.min(e[2],i[n]),l=O(e[0]+Math.abs(e[0]-e[2])*this.latLabelPosition_,r,o),h=[l,i[s+1]+(i[n+1]-i[s+1])*(l-i[s])/(i[n]-i[s])],_=this.parallelsLabels_[a].geom;return _.setCoordinates(h),_},e.prototype.getParallels=function(){return this.parallels_},e.prototype.updateProjectionInfo_=function(t){var e=x("EPSG:4326"),a=t.getWorldExtent();this.maxLat_=a[3],this.maxLon_=a[2],this.minLat_=a[1],this.minLon_=a[0];var i=b(t,e);if(this.minLon_<this.maxLon_)this.toLonLatTransform_=i;else{var s=this.minLon_+this.maxLon_/2;this.maxLon_+=360,this.toLonLatTransform_=function(t,e,a){for(var n=a||2,r=i(t,e,n),o=0,l=r.length;o<l;o+=n)r[o]<s&&(r[o]+=360);return r}}this.fromLonLatTransform_=b(e,t);var n=R([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=n[0],this.maxX_=n[2],this.minY_=n[1],this.maxY_=n[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_(X(t.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=t},e}(f);t("data-v-34af4687");const Q={id:"map",class:"map__x"};e();const H={setup(t){const e=a(),o=i(null);return s((()=>{e.commit("setComponentPath","src/views/OpenLayers/Basic/pages/Graticule/Graticule.vue"),o.value=new W({target:"map",layers:[new c({source:new U({key:"AiZrfxUNMRpOOlCpcMkBPxMUSKOEzqGeJTcVKUrXBsUdQDXutUBFN3-GnMNSlso-",imagerySet:"Road"})})],view:new z({projection:"EPSG:4326",center:[114.064839,22.548857],zoom:6})}),new Z({strokeStyle:new h({color:"rgba(255, 120, 0, .5)",width:2,lineDash:[4]}),showLabels:!0}).setMap(o.value)})),(t,e)=>(r(),n("div",Q))},__scopeId:"data-v-34af4687"};export{H as default};
